#include <iostream>
#include <cmath>
#include <algorithm>

using namespace std;

const double EPS = 1e-12;    // Машинный ноль условно 
const double BIG = 1e100;     // Граница Очень большое число
const double SMALL = 1e-100;  // Граница машинного нуля


void chek_gr(double a, double b, double c, double v[3]) {
    
    //ищем максимальное По модулю среди 3х коэф a b c
    double ma = max(fabs(b), fabs(c));
    double mama = max(fabs(a), ma);
    
    
    if (mama > BIG) { //чекаем не сильно ли большой коэф. не будет ли переполнения
        double w = 1.0 / mama; // Масштабируем , чтобы избежать переполнения  при дальнейшем вычисление Dis
        v[0] = a * w;
        v[1] = b * w;
        v[2] = c * w;
    }

    else if (mama < SMALL && mama > 0) {// Масштабируем , чтобы избежать потери точности при дальнейшем вычисление Dis
        double w = 1.0 / mama;
        v[0] = a * w;
        v[1] = b * w;
        v[2] = c * w;
    }
    else {
        v[0] = a;
        v[1] = b;
        v[2] = c;
    }
}

void korn(double a, double b, double c) {
    cout.precision(10);
    cout << "Уравнение: " << a << "x^2 + " << b << "x + " << c << " = 0\n";
    double v[3];
    chek_gr(a, b, c, v);

    double a1 = v[0];
    double b1 = v[1];
    double c1 = v[2];

    if (fabs(a1) < EPS) {
        //  a = 0 
        if (fabs(b1) < EPS)
        {
            if (fabs(c1) < EPS)
            {
                cout << "Все числа являются решениями\n";//a,b,c=0
            }
            else
            {
                cout << "Нет решений\n";//c>0 ,a a=0 b=0
            }
        }
        else
        {
            cout << "Корень: x = " << -c1 / b1 << "\n"; //a=0
        }
        return;
    }

    // дискриминант
    double d = b1 * b1 - 4 * a1 * c1;
     if (d < -EPS) {//комплексные корни
        double real = -b1 / (2 * a1);
        double mnim = sqrt(-d) / (2 * a1);
        cout << "Комплексные корни:\n";
        cout << "x1 = " << real << " + " << mnim << "i\n";
        cout << "x2 = " << real << " - " << mnim << "i\n";
        return;
    }
    double sqrt_dis = sqrt(fabs(d));
    double x1, x2;


    if (b >= 0) {
        x1 = (-b - sqrt_dis) / (2 * a);
    }
    else {
        x1 = (-b + sqrt_dis) / (2 * a);
    }
    if (fabs(x1) > EPS) {// Если x1 не слишком маленький корень через  Виета
        x2 = c / (a * x1);
    }
    else {
        x2 = (-b - sqrt_dis) / (2 * a);
    }

    cout << " корни:\n";
    cout << "x1 = " << x1 << "\n";
    cout << "x2 = " << x2 << "\n";
}

int main() {
    setlocale(LC_ALL, "rus");
    cout << " ax^2 + bx + c = 0 \n";

    // Тесты из лабораторной работы
    cout << "\n--- Пример 1:  ---\n";
    korn(1, -1000, 1);

    cout << "\n--- Пример 2: ---\n";
    korn(6, 5, -4);

    cout << "\n--- Пример 3:  ---\n";
    korn(6e30, 5e-30, -4e30);

    cout << "\n--- Пример 4:  ---\n";
    korn(10e-30, -10e30, 10e30);

    cout << "\n--- Пример 5:  ---\n";
    korn(1.0000000, -4.0000000, 3.9999999);

    
}
